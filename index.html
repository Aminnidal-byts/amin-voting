<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ভোটিং সিস্টেম - নাম দিয়ে ভোট</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #667eea, #764ba2); margin: 0; padding: 20px; color: #1e293b; }
    .container { max-width: 900px; margin: auto; background: rgba(255,255,255,0.7); backdrop-filter: blur(10px); padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
    h1 { text-align: center; color: white; }
    .candidates { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; margin: 30px 0; }
    .candidate { text-align: center; padding: 25px; border-radius: 20px; width: 250px; background: rgba(255,255,255,0.8); box-shadow: 0 8px 32px rgba(0,0,0,0.1); transition: all 0.3s; }
    .candidate:hover { transform: translateY(-10px); }
    .symbol img { width: 80px; height: auto; margin: 10px 0; }
    button { padding: 14px 32px; font-size: 1.1em; margin: 8px; border: none; border-radius: 12px; color: white; cursor: pointer; transition: all 0.3s; }
    .kolom { background: #10b981; }
    .boi   { background: #f59e0b; }
    .shapla{ background: #ef4444; }
    .admin-btn { background: #4f46e5; }
    .back-btn { background: #7c3aed; }
    .reset-btn { background: #ef4444; }
    section { margin: 30px 0; padding: 25px; background: rgba(255,255,255,0.9); border-radius: 15px; }
    input { padding: 12px; font-size: 1.1em; width: 100%; max-width: 400px; border-radius: 10px; border: 1px solid #ccc; }
    #message { font-size: 1.3em; text-align: center; font-weight: bold; margin: 20px 0; }
    .success { color: #10b981; }
    .error { color: #ef4444; }
    .result-bar { background: #e0e0e0; border-radius: 10px; margin: 10px 0; overflow: hidden; height: 35px; }
    .bar-fill { height: 100%; color: white; text-align: center; font-weight: bold; transition: width 0.5s; }
  </style>
</head>
<body>

<div class="container">
  <h1>ভোটিং সিস্টেম</h1>

  <button class="admin-btn" onclick="showAdminLogin()">অ্যাডমিন প্যানেল</button>

  <section id="admin-login" style="display:none;">
    <h2>অ্যাডমিন লগইন</h2>
    <input type="password" id="adminPass" placeholder="পাসওয়ার্ড ">
    <button onclick="loginAdmin()">লগইন</button>
  </section>

  <section id="admin-section" style="display:none;">
    <h2>অ্যাডমিন প্যানেল</h2>
    <div id="admin-results"></div>
    <div id="voted-list"></div>
    <button class="back-btn" onclick="backToVoting()">← ভোটিং পেজে ফিরে যাও</button>
    <button class="reset-btn" onclick="resetAllVotes()">সব ভোট রিসেট করো</button>
    <button onclick="logoutAdmin()">লগআউট</button>
  </section>

  <section id="voter-section">
    <h2>তোমার নাম লিখো</h2>
    <input type="text" id="voterName" placeholder="যেমন: আমিন, রহিম..." autocomplete="off">
    <button onclick="startVoting()">ভোট দিতে যাও →</button>
  </section>

  <section id="vote-section" style="display:none;">
    <h2>কাকে ভোট দেবে?</h2>
    <div class="candidates">
      <div class="candidate">
        <div class="symbol"><img src="https://c8.alamy.com/comp/HCDFPA/voting-symbols-with-fountain-pen-over-white-paper-HCDFPA.jpg" alt="কলম"></div>
        <div class="name">ইসফাক আমিন নিলফাজ</div>
        <div>মার্কা: কলম</div>
        <button class="kolom" onclick="vote('কলম')">কলম-এ ভোট দাও</button>
      </div>
      <div class="candidate">
        <div class="symbol"><img src="https://thumbs.dreamstime.com/b/open-book-cartoon-vector-symbol-icon-design-beautiful-illustrat-illustration-isolated-white-background-97272378.jpg" alt="বই"></div>
        <div class="name">ইরফান বিন আমিন নিহাল</div>
        <div>মার্কা: বই</div>
        <button class="boi" onclick="vote('বই')">বই-এ ভোট দাও</button>
      </div>
      <div class="candidate">
        <div class="symbol"><img src="https://i.ytimg.com/vi/6LZakbFUjgg/maxresdefault.jpg" alt="শাপলা"></div>
        <div class="name">আয়েশা বিনতে আমিন</div>
        <div>মার্কা: শাপলা</div>
        <button class="shapla" onclick="vote('শাপলা')">শাপলা-এ ভোট দাও</button>
      </div>
    </div>
  </section>

  <div id="message"></div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-database-compat.js"></script>

<script>
// তোমার firebaseConfig এখানে পেস্ট করো
const firebaseConfig = {
  apiKey: "AIzaSy...GMP-4", // তোমারটা দাও
  authDomain: "amin-voting-5ficd.firebaseapp.com",
  databaseURL: "https://amin-voting-5ficd-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "amin-voting-5ficd",
  storageBucket: "amin-voting-5ficd.firebasestorage.app",
  messagingSenderId: "946435860615",
  appId: "1:946435860615:web:914560cae6e28133133bea"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let currentVoter = null;
const adminPassword = "admin";

function showAdminLogin() {
  document.getElementById('admin-login').style.display = 'block';
  document.getElementById('voter-section').style.display = 'none';
  document.getElementById('vote-section').style.display = 'none';
  showMessage('', '');
}

function loginAdmin() {
  if (document.getElementById('adminPass').value === adminPassword) {
    document.getElementById('admin-login').style.display = 'none';
    document.getElementById('admin-section').style.display = 'block';
    loadAdminResults();
    showMessage('অ্যাডমিন প্যানেলে স্বাগতম!', 'success');
  } else {
    showMessage('ভুল পাসওয়ার্ড!', 'error');
  }
}

function logoutAdmin() {
  document.getElementById('admin-section').style.display = 'none';
  document.getElementById('voter-section').style.display = 'block';
}

function backToVoting() {
  document.getElementById('admin-section').style.display = 'none';
  document.getElementById('voter-section').style.display = 'block';
}

function startVoting() {
  currentVoter = document.getElementById('voterName').value.trim();
  if (!currentVoter) return showMessage("নাম লিখো!", 'error');

  db.ref('voterVotes/' + currentVoter).once('value').then(snap => {
    if (snap.exists()) {
      showMessage(`"${currentVoter}" ইতিমধ্যে ভোট দিয়েছে!`, 'error');
    } else {
      document.getElementById('voter-section').style.display = 'none';
      document.getElementById('vote-section').style.display = 'block';
      showMessage(`হ্যালো ${currentVoter} — ভোট দাও`, 'success');
    }
  });
}

function vote(symbol) {
  db.ref('votes/' + symbol).transaction(count => (count || 0) + 1);
  db.ref('voted').push(currentVoter);
  db.ref('voterVotes/' + currentVoter).set(symbol);

  showMessage(`ধন্যবাদ ${currentVoter}! তোমার ভোট গ্রহণ করা হয়েছে।`, 'success');
  document.getElementById('vote-section').style.display = 'none';
  document.getElementById('voter-section').style.display = 'block';
  document.getElementById('voterName').value = '';
}

function loadAdminResults() {
  db.ref('votes').on('value', snap => {
    const votes = snap.val() || {};
    const total = Object.values(votes).reduce((a,b)=>a+b,0) || 0;

    let html = '';
    const cands = [
      {key:'কলম', name:'কলম (নিলফাজ)', color:'#10b981'},
      {key:'বই', name:'বই (নিহাল)', color:'#f59e0b'},
      {key:'শাপলা', name:'শাপলা (আয়েশা)', color:'#ef4444'}
    ];

    cands.forEach(c => {
      const count = votes[c.key] || 0;
      const pct = total ? Math.round(count / total * 100) : 0;
      html += `<div><strong>${c.name}: ${count} (${pct}%)</strong><div class="result-bar"><div class="bar-fill" style="width:${pct}%;background:${c.color};">${pct}%</div></div></div>`;
    });

    html += `<p>মোট ভোট: ${total}</p>`;
    document.getElementById('admin-results').innerHTML = html;
  });

  db.ref('voted').on('value', snap => {
    let list = [];
    snap.forEach(child => list.push(child.val()));
    document.getElementById('voted-list').innerHTML = list.map(v => `<li>${v}</li>`).join('');
  });
}

function resetAllVotes() {
  if (confirm('সব রিসেট করবে?')) {
    db.ref().remove();
    showMessage('রিসেট হয়েছে!', 'success');
  }
}

function showMessage(text, type) {
  const el = document.getElementById('message');
  el.textContent = text;
  el.className = type;
}
</script>
</body>
</html>
